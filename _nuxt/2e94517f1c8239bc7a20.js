(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{506:function(t,e,n){"use strict";n.r(e);n(36),n(23),n(11),n(14),n(4),n(24),n(37),n(7);var r=n(0),o=n(15),l=n(20),c=n(43),d=n.n(c);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,n)}return e}var f,v,h,k,I={data:function(){return{date:!1,valid:!1,loading:!1,value:"Hello!",reportYears:[{id:2017,val:"2017-2018"},{id:2018,val:"2018-2019"},{id:2019,val:"2019-2020"},{id:2020,val:"2020-2021"}],selectedYear:0,dialog:!1,headers:[{text:"Id",align:"left",value:"id"},{text:"Classifcation",value:"classifcation"},{text:"Roles",value:"roles"},{text:"Designation",value:"designation"},{text:"Brief Report",value:"briefReport"},{text:"Approval Status",value:"approvalStatus"},{text:"Actions",value:"action",sortable:!1}],assignment:{annualYear:0,approvalStatus:"PENDING",approvedBy:"",approvedDate:"",briefReport:"Enter brief report here...",classifcation:"",departmentId:0,designation:"",rejectedReason:"",roles:"",status:"VALID",userProfileId:0},editedIndex:-1,editedItem:{annualYear:0,approvalStatus:"PENDING",approvedBy:"",approvedDate:"",briefReport:"",classifcation:"",departmentId:0,designation:"",rejectedReason:"",roles:"",status:"VALID",userProfileId:0},deletedItem:{annualYear:0,approvalStatus:"PENDING",approvedBy:"",approvedDate:"",briefReport:"",classifcation:"",departmentId:0,designation:"",rejectedReason:"",roles:"",status:"VALID",userProfileId:0},approvals:["PENDING","REJECTED","APPROVED"],classifications:[{value:"INTERNATION",name:"International"},{value:"NATIONAL",name:"National"},{value:"NOT_APPLICABLE",name:"Not Applicable"},{value:"OTHERS",name:"Others"}],snackbar:!1,timeout:2e3,submitMessage:"Added sucessfully!"}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(source,!0).forEach(function(e){Object(o.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}({},Object(l.c)({success:function(t){return t.assignment.assignmentsData.status},assignmentsData:function(t){return t.assignment.assignmentsData.result},errorData:function(t){return t.assignment.assignmentsData.error},usersData:function(t){return t.user.userProfile.result},selectedYear:function(t){return t.selectedYear},userProfile:function(t){return t.user.userProfile},myDepartment:function(t){return t.myDepartment},staffs:function(t){return t.staffs}}),{},Object(l.b)(["activities"]),{formTitle:function(){return-1===this.editedIndex?"New Item":"Edit Item"}}),watch:{dialog:function(t){t||this.close()}},fetch:(k=Object(r.a)(regeneratorRuntime.mark(function t(e){var n,r,o,l,c=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.store,r=n.state.auth.user.id,t.next=4,n.dispatch("user/setUserProfile",{id:r}).catch(function(t){c.snackbar=!0,c.submitMessage=t});case 4:return o=n.state.user.userProfile.result.departmentId,t.next=7,n.dispatch("setMyDepartment",{id:o}).catch(function(t){c.snackbar=!0,c.submitMessage=t});case 7:if(l="","ROLE_FACULTY"!==n.state.auth.user.authorities[0]&&"ROLE_STUDENT"!==n.state.auth.user.authorities[0]){t.next=14;break}return l="departmentId.equals=".concat(o,"&userProfileId.equals=").concat(r,"&annualYear.equals=").concat(n.state.selectedYear,"&status.notEquals=DELETED"),t.next=12,n.dispatch("assignment/setAssignmentsData",{qs:l});case 12:t.next=17;break;case 14:return l="departmentId.equals=".concat(o,"&annualYear.equals=").concat(n.state.selectedYear,"&status.notEquals=DELETED"),t.next=17,n.dispatch("assignment/setAssignmentsData",{qs:l});case 17:return t.next=19,n.dispatch("setActivties");case 19:case"end":return t.stop()}},t)})),function(t){return k.apply(this,arguments)}),mounted:function(){this.reset(),this.$store.state.selectedYear?this.selectedYear=this.$store.state.selectedYear:this.$router.push("/admin/activities/faculties"),this.annualYear=this.selectedYear,"ROLE_DEPARTMENT"===this.$store.state.auth.user.authorities[0]&&(this.assignment.approvalStatus="APPROVED")},methods:{changeReportingYear:(h=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("setReportingYear",this.selectedYear);case 2:case"end":return t.stop()}},t,this)})),function(){return h.apply(this,arguments)}),getColor:function(t){return"REJECTED"===t?"red":"PENDING"===t?"orange":"green"},assignmentAdd:(v=Object(r.a)(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.$refs.form.validate()){t.next=8;break}return this.assignment.annualYear=this.selectedYear,0==this.assignment.userProfileId&&(this.assignment.userProfileId=this.usersData.userId),this.assignment.departmentId=this.usersData.departmentId,e=this.assignment,t.next=8,this.$store.dispatch("assignment/assignmentAdd",e).then(function(t){d.a.fire({title:"Success",text:"Added Successfully!",type:"success",showConfirmButton:!1,timer:1500}),n.reset(),n.reloadData()}).catch(function(t){n.snackbar=!0,n.submitMessage=t});case 8:case"end":return t.stop()}},t,this)})),function(){return v.apply(this,arguments)}),reloadData:(f=Object(r.a)(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.loading=!0,e=this.$store.state.user.userProfile.result.departmentId,n=this.$store.state.user.userProfile.result.userId,r="","ROLE_FACULTY"!==this.$store.state.auth.user.authorities[0]&&"ROLE_STUDENT"!==this.$store.state.auth.user.authorities[0]){t.next=10;break}return r="departmentId.equals=".concat(e,"&userProfileId.equals=").concat(n,"&annualYear.equals=").concat(this.annualYear,"&status.notEquals=DELETED"),t.next=8,this.$store.dispatch("assignment/setAssignmentsData",{qs:r});case 8:t.next=13;break;case 10:return r="departmentId.equals=".concat(e,"&annualYear.equals=").concat(this.annualYear,"&status.notEquals=DELETED"),t.next=13,this.$store.dispatch("assignment/setAssignmentsData",{qs:r});case 13:this.loading=!1;case 14:case"end":return t.stop()}},t,this)})),function(){return f.apply(this,arguments)}),editItem:function(t){this.editedIndex=this.assignmentsData.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},reset:function(){this.$refs.form.reset()},deleteItem:function(t){var e=this;this.deletedItem=Object.assign({},t),this.deletedItem.id=this.deletedItem.id,this.deletedItem.status="DELETED";var n=this.deletedItem;console.log(n);confirm("Are you sure you want to delete this item?")&&this.$store.dispatch("assignment/updateAssignment",n).then(function(t){d.a.fire({title:"Success",text:"Deleted Successfully!",type:"success",showConfirmButton:!1,timer:1500}),e.reloadData()}).catch(function(t){e.snackbar=!0,e.submitMessage=t})},close:function(){var t=this;this.dialog=!1,setTimeout(function(){t.publicData=Object.assign({},t.defaultItem),t.editedIndex=-1},300)},save:function(){var t=this;if(this.editedIndex>-1){this.editedItem.id=this.assignmentsData[this.editedIndex].id,this.editedItem.userProfileId=this.assignmentsData[this.editedIndex].userProfileId,"ROLE_DEPARTMENT"!=this.$store.state.auth.user.authorities[0]&&(this.editedItem.approvalStatus="PENDING");var e=this.editedItem;this.$store.dispatch("assignment/updateAssignment",e).then(function(e){d.a.fire({title:"Success",text:"Updated Successfully!",type:"success",showConfirmButton:!1,timer:1500}),t.reloadData()}).catch(function(e){t.snackbar=!0,t.submitMessage="Something Wrong!"})}else console.log(this.assignmentsData.push(this.editedItem));this.close()}}},x=n(3),component=Object(x.a)(I,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("div",{staticClass:"wrapper-bg",attrs:{id:"sc-page-wrapper"}},[n("div",{attrs:{id:"sc-page-content"}},[n("div",{staticClass:"uk-text-center uk-grid",attrs:{"data-uk-grid":""}},[n("div",{staticClass:"uk-width-auto"},[n("div",{staticClass:"page-title"},[n("h1",{staticClass:"uk-margin-medium-left"},[t._v("\n\t\t\t\t\t\t\tKey Assignments\n\t\t\t\t\t\t")])])]),t._v(" "),n("div",{staticClass:"uk-width-expand@s uk-align-right@s"},[n("div",{staticClass:"uk-align-right",attrs:{"data-uk-form-custom":"target: > * > span:first-child"}},[n("v-select",{staticClass:"text-center",attrs:{items:t.reportYears,"item-text":"val","item-value":"id",label:"Reporting Year",required:""},on:{input:t.changeReportingYear},model:{value:t.selectedYear,callback:function(e){t.selectedYear=e},expression:"selectedYear"}})],1)])]),t._v(" "),n("div",{staticClass:"uk-text-center",attrs:{"uk-grid":""}},[n("div",{staticClass:"uk-width-1-4@s uk-width-1-1"},[n("div",{staticClass:"uk-card uk-card-primary"},[n("ul",{staticClass:"uk-margin-left uk-nav-default uk-nav-parent-icon uk-text-left uk-text-bold uk-padding-small",attrs:{"uk-nav":""}},t._l(t.activities,function(e,r){return n("li",{key:r,staticClass:"uk-padding-small-bottom"},[n("nuxt-link",{staticClass:"uk-text-normal",attrs:{to:e.path}},[n("span",{staticClass:"uk-margin-small-right",attrs:{"uk-icon":e.icon}}),t._v(" "+t._s(e.title)+"\n\t\t\t\t\t\t\t\t")])],1)}),0)])]),t._v(" "),n("div",{staticClass:"uk-width-3-4@s uk-width-1-1"},[n("div",{staticClass:"uk-card uk-card-default uk-card-body uk-text-left"},[n("v-row",{attrs:{"no-gutters":""}},["ROLE_DEPARTMENT"===t.$store.state.auth.user.authorities[0]?n("v-col",{attrs:{cols:"12",md:"12"}},[n("v-select",{attrs:{items:t.staffs,"item-value":"id","item-text":"firstname",filled:"",label:"Data from (Select Faculty) *"},model:{value:t.assignment.userProfileId,callback:function(e){t.$set(t.assignment,"userProfileId",e)},expression:"assignment.userProfileId"}})],1):t._e()],1),t._v(" "),n("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){t.preventDefault()}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{rules:[function(t){return!!t||"Item is required"}],items:t.classifications,"item-text":"name","item-value":"value",label:"Classification *"},model:{value:t.assignment.classifcation,callback:function(e){t.$set(t.assignment,"classifcation",e)},expression:"assignment.classifcation"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{rules:[function(t){return!!t||"Item is required"}],label:"Roles *",required:""},model:{value:t.assignment.roles,callback:function(e){t.$set(t.assignment,"roles",e)},expression:"assignment.roles"}})],1)],1),t._v(" "),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{rules:[function(t){return!!t||"Item is required"}],items:t.staffs,"item-text":"firstname","item-value":"id",label:"Faculty Name *"},model:{value:t.assignment.userProfileId,callback:function(e){t.$set(t.assignment,"userProfileId",e)},expression:"assignment.userProfileId"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{rules:[function(t){return!!t||"Item is required"}],label:"Designation *",required:""},model:{value:t.assignment.designation,callback:function(e){t.$set(t.assignment,"designation",e)},expression:"assignment.designation"}})],1)],1),t._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-container",{attrs:{fluid:""}},[n("v-textarea",{attrs:{rules:[function(t){return!!t||"Item is required"}],counter:"1000",maxlength:"1000",hint:"Only 1000 Characters are allowed.",label:"Brief Report *"},model:{value:t.assignment.briefReport,callback:function(e){t.$set(t.assignment,"briefReport",e)},expression:"assignment.briefReport"}})],1)],1)],1),t._v(" "),n("span",{staticStyle:{color:"red","font-size":"12px"}},[t._v("* Mandatory fields")])],1),t._v(" "),n("div",{staticClass:"uk-width-1-1"},[n("div",{staticClass:"uk-width-expand"}),t._v(" "),n("div",{staticClass:"uk-form-controls uk-width-auto uk-align-right"},[n("v-btn",{attrs:{medium:"",color:"#d74f4f",dark:""},on:{click:t.reset}},[t._v("\n\t\t\t\t\t\t\t\t\t\tReset\n\t\t\t\t\t\t\t\t\t")]),t._v(" "),n("v-btn",{attrs:{medium:"",color:"#57a727",dark:""},on:{click:t.assignmentAdd}},[t._v("\n\t\t\t\t\t\t\t\t\t\tSubmit\n\t\t\t\t\t\t\t\t\t")])],1)])],1),t._v(" "),n("v-snackbar",{attrs:{timeout:t.timeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.submitMessage)+"\n\t\t\t\t\t\t\t"),n("v-btn",{attrs:{color:"blue",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v("\n\t\t\t\t\t\t\t\tClose\n\t\t\t\t\t\t\t")])],1)],1)])]),t._v(" "),n("hr"),t._v(" "),n("v-app",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.assignmentsData,"sort-by":"id","sort-desc":"",loading:t.loading,"loading-text":"Loading... Please wait"},scopedSlots:t._u([{key:"item.approvalStatus",fn:function(e){var r=e.item;return[n("v-chip",{attrs:{color:t.getColor(r.approvalStatus),dark:""}},[t._v("\n\t\t\t\t\t\t\t"+t._s(r.approvalStatus)+"\n\t\t\t\t\t\t")])]}},{key:"top",fn:function(){return[n("v-toolbar",{staticClass:"d-flex justify pt-1",attrs:{flat:"",color:"#ebebeb"}},[n("v-toolbar-title",[n("span",{staticClass:"frm-title"},[t._v("Key Assignments")])]),t._v(" "),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t._v(" "),n("v-select",{staticClass:"justify-end mt-6",attrs:{items:t.reportYears,"item-text":"val","item-value":"id",label:"Reporting Year",required:""},on:{change:function(e){return t.reloadData()}},model:{value:t.annualYear,callback:function(e){t.annualYear=e},expression:"annualYear"}}),t._v(" "),n("v-spacer"),t._v(" "),n("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-toolbar",{attrs:{dark:"",color:"#4da96b"}},[n("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){t.dialog=!1}}},[n("v-icon",[t._v("mdi-close")])],1),t._v(" "),n("v-toolbar-title",[t._v("Key Assignments | Update Details")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-toolbar-items",[n("v-btn",{attrs:{dark:"",text:""},on:{click:t.close}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t\t\t\t\t\t")]),t._v(" "),n("v-btn",{attrs:{dark:"",text:""},on:{click:t.save}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t\t\t\t\t")])],1)],1),t._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{items:t.classifications,"item-text":"name","item-value":"value",label:"Classification *"},model:{value:t.editedItem.classifcation,callback:function(e){t.$set(t.editedItem,"classifcation",e)},expression:"editedItem.classifcation"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-select",{attrs:{items:t.staffs,"item-text":"firstname","item-value":"id",label:"Faculty Name *"},model:{value:t.editedItem.userProfileId,callback:function(e){t.$set(t.editedItem,"userProfileId",e)},expression:"editedItem.userProfileId"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Designation *"},model:{value:t.editedItem.designation,callback:function(e){t.$set(t.editedItem,"designation",e)},expression:"editedItem.designation"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Roles *"},model:{value:t.editedItem.roles,callback:function(e){t.$set(t.editedItem,"roles",e)},expression:"editedItem.roles"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{counter:"1000",maxlength:"1000",label:"Brief Report *",hint:"Only 1000 Characters are allowed."},model:{value:t.editedItem.briefReport,callback:function(e){t.$set(t.editedItem,"briefReport",e)},expression:"editedItem.briefReport"}})],1),t._v(" "),n("span",{staticStyle:{color:"red","font-size":"12px"}},[t._v("* Mandatory fields")])],1)],1)],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(e){var r=e.item;return[n("span",{staticClass:"uk-margin-small-right edit-icon",attrs:{"uk-icon":"pencil"},on:{click:function(e){return t.editItem(r)}}}),t._v(" "),n("span",{staticClass:"delete-icon",attrs:{"uk-icon":"trash"},on:{click:function(e){return t.deleteItem(r)}}})]}},{key:"no-data",fn:function(){return[n("v-btn",{attrs:{color:"primary"}},[t._v("\n\t\t\t\t\t\t\tReset\n\t\t\t\t\t\t")])]},proxy:!0}])})],1)],1)])])},[],!1,null,null,null);e.default=component.exports}}]);